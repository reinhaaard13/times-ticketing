(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[856],{1391:function(e,n,t){"use strict";t.d(n,{Ph:function(){return j}});var r=t(9762),i=t(2846),s=t(4244),a=t(5031),c=t(8554),o=t.n(c),l=t(7294);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},u.apply(this,arguments)}function d(e,n){if(null==e)return{};var t,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}var h=["children","placeholder","className"],p=["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize"],m=["children"],x=(0,i.Gp)((function(e,n){var t=e.children,r=e.placeholder,s=e.className,c=d(e,h);return l.createElement(i.m$.select,u({},c,{ref:n,className:(0,a.cx)("chakra-select",s)}),r&&l.createElement("option",{value:""},r),t)}));a.Ts&&(x.displayName="SelectField");var j=(0,i.Gp)((function(e,n){var t=(0,i.jC)("Select",e),c=(0,i.Lr)(e),h=c.rootProps,m=c.placeholder,j=c.icon,f=c.color,v=c.height,_=c.h,b=c.minH,C=c.minHeight,I=c.iconColor,k=c.iconSize,S=d(c,p),y=(0,a.Vl)(S,s.oE),N=y[0],w=y[1],E=(0,r.Yp)(w),B={width:"100%",height:"fit-content",position:"relative",color:f},P=o()({paddingEnd:"2rem"},t.field,{_focus:{zIndex:"unset"}});return l.createElement(i.m$.div,u({className:"chakra-select__wrapper",__css:B},N,h),l.createElement(x,u({ref:n,height:null!=_?_:v,minH:null!=b?b:C,placeholder:m},E,{__css:P}),e.children),l.createElement(g,u({"data-disabled":(0,a.PB)(E.disabled)},(I||f)&&{color:I||f},{__css:t.icon},k&&{fontSize:k}),j))}));a.Ts&&(j.displayName="Select");var f=function(e){return l.createElement("svg",u({viewBox:"0 0 24 24"},e),l.createElement("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}))},v=(0,i.m$)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),g=function(e){var n=e.children,t=void 0===n?l.createElement(f,null):n,r=d(e,m),i=l.cloneElement(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return l.createElement(v,u({},r,{className:"chakra-select__icon-wrapper"}),l.isValidElement(t)?i:null)};a.Ts&&(g.displayName="SelectIcon")},3441:function(e,n,t){"use strict";t.d(n,{g:function(){return u}});var r=t(9762),i=t(2846),s=t(5031),a=t(7294);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},c.apply(this,arguments)}var o=["className","rows"],l=["h","minH","height","minHeight"],u=(0,i.Gp)((function(e,n){var t=(0,i.mq)("Textarea",e),u=(0,i.Lr)(e),d=u.className,h=u.rows,p=function(e,n){if(null==e)return{};var t,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(u,o),m=(0,r.Yp)(p),x=h?(0,s.CE)(t,l):t;return a.createElement(i.m$.textarea,c({ref:n,rows:h},m,{className:(0,s.cx)("chakra-textarea",d),__css:x}))}));s.Ts&&(u.displayName="Textarea")},8018:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ticket/new",function(){return t(6295)}])},6295:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return F},default:function(){return T}});var r=t(5893),i=t(7294),s=t(9008),a=t.n(s),c=t(6662),o=t(7568),l=t(943);var u=t(3375);var d=t(1566);function h(e){return function(e){if(Array.isArray(e))return(0,l.Z)(e)}(e)||(0,u.Z)(e)||(0,d.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=t(4051),m=t.n(p),x=t(2175),j=t(1163),f=t(1895),v=t(7375),g=t(6658),_=t(8790),b=t(5193),C=t(9762),I=t(1391),k=t(4612),S=t(3441),y=function(e){return(0,r.jsx)(i.Fragment,{children:(0,r.jsx)("input",{type:"file",accept:".jpg, .png, .jpeg, .pdf",onChange:e.onPickedImage,name:e.name,id:e.id,multiple:!0})})},N=t(9669),w=t.n(N),E=["IT","BA","MKT","OPR"],B=function(e){var n={};return e.location||(n.location="Location is required"),e.cust_name||(n.cust_name="Customer name is required"),e.cust_no||(n.cust_no="Customer number is required"),e.cust_email||(n.cust_email="Customer email is required"),e.product||(n.product="Product is required"),e.subproduct||(n.subproduct="Subproduct is required"),e.assigned_to||(n.assigned_to="Choose who you assign this ticket to"),e.casesubject||(n.casesubject="Pick a subject for this ticket"),e.description||(n.description="Describe the issue"),n},P=function(e){var n,t,s,a=e.products,c=(0,v.qY)(),l=c.isOpen,u=c.onOpen,d=c.onClose,p=(0,i.useState)({}),N=p[0],P=p[1],F=(0,j.useRouter)(),T=(0,f.a)().token,O=(0,x.TA)({initialValues:{location:"",cust_name:"",cust_no:"",cust_email:"",product:"",subproduct:"",assigned_to:"",casesubject:"",description:"",attachment:""},validate:B,onSubmit:function(){var e=(0,o.Z)(m().mark((function e(n){var t,r;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.setSubmitting(!0),(t=new FormData).append("location",n.location),t.append("cust_name",n.cust_name),t.append("cust_no",n.cust_no),t.append("cust_email",n.cust_email),t.append("product",n.product),t.append("subproduct",n.subproduct),t.append("assigned_to",n.assigned_to),t.append("casesubject",n.casesubject),t.append("description",n.description),h(n.attachment).forEach((function(e){t.append("attachment",e)})),t.append("created_by","admin"),e.prev=13,e.next=16,w().post("/api/tickets",t,{headers:{Authorization:"Bearer ".concat(T)}});case 16:r=e.sent,O.resetForm(),P(r.data.newTicket),u(),e.next=24;break;case 22:e.prev=22,e.t0=e.catch(13);case 24:O.setSubmitting(!1);case 25:case"end":return e.stop()}}),e,null,[[13,22]])})));return function(n){return e.apply(this,arguments)}}()});return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)(g.u_,{isOpen:l,onClose:d,children:[(0,r.jsx)(g.ZA,{}),(0,r.jsxs)(g.hz,{children:[(0,r.jsx)(g.xB,{children:"Successfully created!"}),(0,r.jsx)(g.ol,{}),(0,r.jsxs)(g.fe,{children:["The ticket has been successfully created! Your ticket ID is"," ",(0,r.jsx)(_.xv,{align:"center",fontSize:"lg",fontWeight:"semibold",children:N.ticket_id})]}),(0,r.jsxs)(g.mz,{children:[(0,r.jsx)(b.zx,{mr:3,onClick:d,children:"Create another ticket"}),(0,r.jsx)(b.zx,{colorScheme:"teal",onClick:function(){F.push("/")},children:"Back to home"})]})]})]}),(0,r.jsx)("form",{onSubmit:O.handleSubmit,children:(0,r.jsx)(_.xu,{width:"full",maxW:"2xl",bg:"whiteAlpha.900",backdropFilter:"auto",backdropBlur:"md",p:4,rounded:"2xl",shadow:"lg",children:(0,r.jsxs)(_.kC,{flexDirection:"column",children:[(0,r.jsxs)(_.kC,{flexDir:["column","row"],children:[(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.product&&O.touched.product,children:[(0,r.jsx)(C.lX,{htmlFor:"product",children:"Choose Product"}),(0,r.jsx)(I.Ph,{id:"product",name:"product",placeholder:"Select Product",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.product,children:a.map((function(e,n){return(0,r.jsx)("option",{value:e.product_id,children:e.product_name},n)}))}),(0,r.jsx)(C.J1,{children:O.errors.product})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.subproduct&&O.touched.subproduct,children:[(0,r.jsx)(C.lX,{htmlFor:"subproduct",children:"Choose Sub Product"}),(0,r.jsx)(I.Ph,{id:"subproduct",name:"subproduct",placeholder:"Select Sub Product",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.subproduct,children:null===(n=a.find((function(e){return e.product_id===parseInt(O.values.product)})))||void 0===n?void 0:n.Subproducts.map((function(e,n){return(0,r.jsx)("option",{value:e.subproduct_id,children:e.subproduct_name},n)}))}),(0,r.jsx)(C.J1,{children:O.errors.subproduct})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.casesubject&&O.touched.casesubject,children:[(0,r.jsx)(C.lX,{htmlFor:"casesubject",children:"Choose Case Subject"}),(0,r.jsx)(I.Ph,{id:"casesubject",name:"casesubject",placeholder:"Select Case Subject",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.casesubject,children:null===(s=null===(t=a.find((function(e){return e.product_id===parseInt(O.values.product)})))||void 0===t?void 0:t.Subproducts.find((function(e){return e.subproduct_id===parseInt(O.values.subproduct)})))||void 0===s?void 0:s.CaseSubjects.map((function(e,n){return(0,r.jsx)("option",{value:e.id,children:e.subject},n)}))}),(0,r.jsx)(C.J1,{children:O.errors.casesubject})]})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.location&&O.touched.location,children:[(0,r.jsx)(C.lX,{htmlFor:"location",children:"Event Location"}),(0,r.jsx)(k.II,{id:"location",type:"text",name:"location",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.location}),(0,r.jsx)(C.J1,{children:O.errors.location})]}),(0,r.jsxs)(_.kC,{flexDir:["column","row"],children:[(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.cust_name&&O.touched.cust_name,children:[(0,r.jsx)(C.lX,{htmlFor:"cust_name",children:"Customer Name"}),(0,r.jsx)(k.II,{id:"cust_name",type:"text",name:"cust_name",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.cust_name}),(0,r.jsx)(C.J1,{children:O.errors.cust_name})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.cust_no&&O.touched.cust_no,children:[(0,r.jsx)(C.lX,{htmlFor:"cust_no",children:"Customer Phone"}),(0,r.jsx)(k.II,{id:"cust_no",type:"text",name:"cust_no",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.cust_no}),(0,r.jsx)(C.J1,{children:O.errors.cust_no})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.cust_email&&O.touched.cust_email,children:[(0,r.jsx)(C.lX,{htmlFor:"cust_email",children:"Customer Email"}),(0,r.jsx)(k.II,{id:"cust_email",type:"email",name:"cust_email",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.cust_email}),(0,r.jsx)(C.J1,{children:O.errors.cust_email})]})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.description&&O.touched.description,children:[(0,r.jsx)(C.lX,{htmlFor:"description",children:"Description"}),(0,r.jsx)(S.g,{id:"description",name:"description",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.description}),(0,r.jsx)(C.J1,{children:O.errors.description})]}),(0,r.jsxs)(C.NI,{padding:2,isRequired:!0,isInvalid:O.errors.assigned_to&&O.touched.assigned_to,children:[(0,r.jsx)(C.lX,{htmlFor:"assigned_to",children:"Assign To Department"}),(0,r.jsx)(I.Ph,{id:"assigned_to",name:"assigned_to",placeholder:"Select Asignee",onChange:O.handleChange,onBlur:O.handleBlur,value:O.values.assigned_to,children:E.map((function(e,n){return(0,r.jsx)("option",{value:e,children:e},n)}))}),(0,r.jsx)(C.J1,{children:O.errors.assigned_to})]}),(0,r.jsxs)(C.NI,{padding:2,isInvalid:O.errors.attachment,children:[(0,r.jsx)(C.lX,{htmlFor:"attachment",children:"Attachment"}),(0,r.jsx)(y,{onPickedImage:function(e){var n=e.target.files;(null===n||void 0===n?void 0:n.size)>1e7?O.setErrors({attachment:"Attachment size is too large"}):n?O.setFieldValue("attachment",n):O.setFieldValue("attachment",null)},name:"attachment",id:"attachment",value:O.values.attachment}),(0,r.jsx)(C.J1,{children:O.errors.attachment})]}),(0,r.jsx)(_.iz,{margin:2}),(0,r.jsx)(b.zx,{isLoading:O.isSubmitting,loadingText:"Creating Ticket",margin:2,colorScheme:"teal",type:"submit",disabled:!O.isValid,children:"Create Ticket"})]})})})]})},F=!0,T=function(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:"Create New Ticket"})}),(0,r.jsx)(c.Z,{children:(0,r.jsxs)("div",{className:"px-4 w-full flex flex-col items-center",children:[(0,r.jsx)("h1",{className:"my-4 font-semibold text-lime-500 text-2xl",children:"Create new ticket"}),(0,r.jsx)(P,{products:e.products})]})})]})}}},function(e){e.O(0,[228,445,617,556,885,781,518,69,658,662,774,888,179],(function(){return n=8018,e(e.s=n);var n}));var n=e.O();_N_E=n}]);