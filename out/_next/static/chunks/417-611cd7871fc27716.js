(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{7087:function(e,t,n){"use strict";var r=n(5893),o=(n(7294),n(4641)),s=n.n(o),i=n(7361);t.Z=function(e){var t="LOW"===e.severity?s().badge_low:"MEDIUM"===e.severity?s().badge_medium:"HIGH"===e.severity?s().badge_high:"CRITICAL"===e.severity&&s().badge_critical;return(0,r.jsx)("span",{className:"".concat(s().badge," ").concat(t," ").concat(e.checked&&s().checked),children:"".concat(i.Y.find((function(t){return t.label===e.severity})).label)})}},8794:function(e,t,n){"use strict";var r=n(7568),o=n(4051),s=n.n(o),i=n(5893),c=(n(7294),n(381)),a=n.n(c),l=n(9669),d=n.n(l),u=n(1895),h=n(5074),x=n(6658),p=n(8790),j=n(5193),v=n(5434),f=n(9583),m=n(7087);t.Z=function(e){var t,n,o,c,l,g,_,k=(0,u.a)().token,C=(0,h.pm)(),b=function(){var t=(0,r.Z)(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d().patch("/api/tickets/".concat(e.ticket.ticket_id,"/status"),{status:"PROGRESS"},{headers:{Authorization:"Bearer ".concat(k)}});case 3:t.sent,e.onConfirm(),e.onClose(),t.next=14;break;case 8:t.prev=8,t.t0=t.catch(0),e.onClose(),console.log(t.t0),C({title:"An error occured",description:"".concat(null===(n=t.t0.response)||void 0===n?void 0:n.data.error),position:"top",status:"error",isClosable:!0,variant:"left-accent"});case 14:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();return(0,i.jsxs)(x.u_,{isOpen:e.isOpen,onClose:e.onClose,children:[(0,i.jsx)(x.ZA,{}),(0,i.jsxs)(x.hz,{children:[(0,i.jsx)(x.xB,{children:"Ticket Description"}),(0,i.jsx)(x.ol,{}),(0,i.jsx)(x.fe,{children:(0,i.jsxs)(p.aV,{className:"text-slate-800/80",spacing:2,children:[(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:v.YTL,color:"teal"}),"Severity:"," ",(0,i.jsx)(m.Z,{severity:null===(t=e.ticket)||void 0===t?void 0:t.CaseSubject.severity})]}),(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:f.QHb,color:"teal"}),"Ticket ID:"," ",(0,i.jsx)("span",{className:"font-semibold uppercase text-slate-800",children:null===(n=e.ticket)||void 0===n?void 0:n.ticket_id})]}),(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:v.dBs,color:"teal"}),"Product:"," ",(0,i.jsx)("span",{className:"font-semibold text-slate-800",children:null===(o=e.ticket)||void 0===o?void 0:o.Product.product_name})]}),(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:v.Vyx,color:"teal"}),"Name:"," ",(0,i.jsx)("span",{className:"font-semibold text-slate-800",children:null===(c=e.ticket)||void 0===c?void 0:c.cust_name})]}),(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:v.vcr,color:"teal"}),"Event Location:"," ",(0,i.jsx)("span",{className:"font-semibold text-slate-800",children:null===(l=e.ticket)||void 0===l?void 0:l.location})]}),(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:v.o2E,color:"teal"}),"Created at:"," ",(0,i.jsx)("span",{className:"font-semibold text-slate-800",children:a()(null===(g=e.ticket)||void 0===g?void 0:g.created_date).format("YYYY-MM-DD HH:mm:ss")})]}),(0,i.jsxs)(p.HC,{children:[(0,i.jsx)(p.DE,{as:v.aHI,color:"teal"}),"Subject:"," ",(0,i.jsx)("span",{className:"font-semibold text-slate-800",children:null===(_=e.ticket)||void 0===_?void 0:_.CaseSubject.subject})]})]})}),(0,i.jsxs)(x.mz,{children:[(0,i.jsx)(j.zx,{mr:3,onClick:e.onClose,children:"Cancel"}),(0,i.jsx)(j.zx,{colorScheme:"blue",onClick:b,children:"Take This Ticket"})]})]})]})}},2417:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var r=n(7568),o=n(4051),s=n.n(o),i=n(5893),c=n(7294),a=n(1664),l=n.n(a),d=n(381),u=n.n(d),h=n(4865),x=n.n(h),p=n(5434),j=n(7516),v=n(9669),f=n.n(v),m=n(1163),g=n(4548),_=n(1895),k=n(8100),C=n(5074),b=n(9042),y=n(4107),T=n(8790),S=n(5193),w=n(7398),O=n(7375),D=n(6893),E=(n(1129),n(7087)),A=n(8794),P=n(6658),B=function(e){var t=(0,_.a)().token,n=(0,C.pm)(),o=function(){var o=(0,r.Z)(s().mark((function r(){var o;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,f().delete("/api/tickets/".concat(e.ticket.ticket_id),{headers:{Authorization:"Bearer ".concat(t)}});case 3:r.sent,e.onDelete(),e.onClose(),r.next=14;break;case 8:r.prev=8,r.t0=r.catch(0),e.onClose(),console.log(r.t0),n({title:"An error occured",description:"".concat(null===(o=r.t0.response)||void 0===o?void 0:o.data.error),position:"top",status:"error",isClosable:!0,variant:"left-accent"});case 14:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(){return o.apply(this,arguments)}}();return(0,i.jsxs)(P.u_,{isOpen:e.isOpen,onClose:e.onClose,children:[(0,i.jsx)(P.ZA,{}),(0,i.jsxs)(P.hz,{children:[(0,i.jsx)(P.xB,{children:"Delete Ticket"}),(0,i.jsx)(P.ol,{}),(0,i.jsxs)(P.fe,{children:[(0,i.jsx)(T.xv,{children:"Are you sure you want to delete this ticket?"}),(0,i.jsx)(T.xv,{fontSize:"sm",textColor:"red",children:"This action cannot be undone"})]}),(0,i.jsxs)(P.mz,{children:[(0,i.jsx)(S.zx,{mr:3,onClick:e.onClose,children:"Cancel"}),(0,i.jsx)(S.zx,{colorScheme:"red",onClick:o,children:"Delete This Ticket"})]})]})]})},Z=n(6042),N=n(9396),H=n(9534),I=n(1391),z=function(e){var t=e.options,n=(0,H.Z)(e,["options"]);return(0,i.jsxs)(b.Th,(0,N.Z)((0,Z.Z)({},n),{children:[(0,i.jsx)(T.xv,{children:n.children}),(0,i.jsx)(I.Ph,{size:"xs",placeholder:"-",onChange:n.onChange,name:n.name,children:null===t||void 0===t?void 0:t.map((function(e){return(0,i.jsx)("option",{value:e.option_value,children:e.option_name},e.option_value)}))})]}))},Y=n(894),L=n(9327),R=function(e){var t=e.children,n=e.sortBy,r=e.sortOrder,o=e.onSort,s=e.column,c=e.width;return(0,i.jsxs)(b.Th,{onClick:function(){return o(s)},_hover:{backgroundColor:"gray.400"},width:c&&c,cursor:"pointer",whiteSpace:"nowrap",children:[t,(0,i.jsx)(Y.JO,{as:n===s?L.qwl:L.CFC,transform:"asc"===r&&n===s?"rotate(180deg)":"rotate(0deg)",marginLeft:1,textColor:n!==s&&"blackAlpha.500"})]},s)},M=function(e){e.initialPage,(0,m.useRouter)();var t=(0,_.a)(),n=t.user,o=t.privileges,a=t.token,d=(0,g.Q)(),h=d.page,v=d.sortBy,P=d.sortOrder,Z=d.filter,N=d.fetchNextPage,H=d.fetchPreviousPage,I=d.changeSort,Y=d.addFilter,L=(0,c.useState)([]),M=L[0],F=L[1],U=(0,k.ZP)(["/api/tickets",h,v,P,Z],function(){var e=(0,r.Z)(s().mark((function e(t,n,r,o,i){var c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x().start(),e.next=3,f().get("".concat(t),{params:{page:n,sortBy:r,sortOrder:o,filter:i},headers:{Authorization:"Bearer ".concat(a)}});case 3:return c=e.sent,x().done(),e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,o,s){return e.apply(this,arguments)}}()),G=U.data,W=U.mutate;console.log("render");var V=(0,O.qY)(),Q=V.isOpen,q=V.onOpen,J=V.onClose,K=(0,O.qY)(),X=K.isOpen,$=K.onOpen,ee=K.onClose,te=(0,c.useState)(null),ne=te[0],re=te[1],oe=(0,C.pm)(),se=function(){var e=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:oe({title:"You have taken this ticket",description:"The ticket with ID ".concat(ne.ticket_id," has been taken by you"),position:"top",status:"success",isClosable:!0,variant:"left-accent"}),W();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:oe({title:"You have deleted the ticket",description:"The ticket with ID ".concat(ne.ticket_id," has been deleted by you"),position:"top",status:"error",isClosable:!0,variant:"left-accent"}),W();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){f().get("/api/tickets/filters").then((function(e){return F(e.data)}))}),[]);var ce=function(e){Y(e.target.name,e.target.value)};return(0,i.jsxs)(c.Fragment,{children:[(0,i.jsx)(A.Z,{isOpen:Q,onClose:J,onConfirm:se,ticket:ne}),(0,i.jsx)(B,{isOpen:X,onClose:ee,onDelete:ie,ticket:ne}),(0,i.jsx)(b.xJ,{whiteSpace:"pre-wrap",shadow:"lg",className:"border border-slate-500/20 rounded-xl w-full",children:(0,i.jsxs)(b.iA,{bg:"whiteAlpha.900",backdropFilter:"auto",backdropBlur:"md",variant:"simple",size:"sm",children:[(0,i.jsxs)(b.hr,{className:"bg-slate-500/20",children:[(0,i.jsxs)(b.Tr,{height:"10",children:[(0,i.jsx)(b.Th,{width:1,children:"No."}),(0,i.jsx)(b.Th,{width:"1",children:"Ticket"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"product",children:"Product"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"subject",children:"Subject"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"created_date",width:"32",children:"Created At"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"severity",children:"Severity"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"pic",children:"PIC"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"created_by",children:"Author"}),(0,i.jsx)(R,{width:1,sortBy:v,sortOrder:P,onSort:I,column:"status",children:"Status"}),(0,i.jsx)(R,{sortBy:v,sortOrder:P,onSort:I,column:"sla",children:"SLA"}),(0,i.jsx)(b.Th,{children:"Action"})]}),(0,i.jsxs)(b.Tr,{children:[(0,i.jsx)(b.Th,{}),(0,i.jsx)(b.Th,{}),(0,i.jsx)(z,{options:M.products,onChange:ce,name:"product"}),(0,i.jsx)(z,{options:M.casesubjects,onChange:ce,name:"subject"}),(0,i.jsx)(b.Th,{}),(0,i.jsx)(z,{options:[{option_value:"LOW",option_name:"Low"},{option_value:"MEDIUM",option_name:"Medium"},{option_value:"HIGH",option_name:"High"},{option_value:"CRITICAL",option_name:"Critical"}],onChange:ce,name:"severity"}),(0,i.jsx)(b.Th,{}),(0,i.jsx)(b.Th,{}),(0,i.jsx)(z,{options:[{option_value:"OPEN",option_name:"Open"},{option_value:"PROGRESS",option_name:"Progress"},{option_value:"CLOSED",option_name:"Closed"}],onChange:ce,name:"status"}),(0,i.jsx)(z,{options:[{option_value:"10",option_name:"in 10 days"},{option_value:"5",option_name:"in 5 days"},{option_value:"3",option_name:"in 3 days"},{option_value:"1",option_name:"in 1 day"},{option_value:"OVERDUE",option_name:"Overdue"}],onChange:ce,name:"sla"}),(0,i.jsx)(b.Th,{})]})]}),(0,i.jsxs)(b.p3,{children:[!G&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Tr,{children:(0,i.jsx)(b.Td,{colSpan:11,textAlign:"center",p:4,children:(0,i.jsx)(y.Od,{height:5})})}),(0,i.jsx)(b.Tr,{children:(0,i.jsx)(b.Td,{colSpan:11,textAlign:"center",p:4,children:(0,i.jsx)(y.Od,{height:5})})}),(0,i.jsx)(b.Tr,{children:(0,i.jsx)(b.Td,{colSpan:11,textAlign:"center",p:4,children:(0,i.jsx)(y.Od,{height:5})})})]}),0===(null===G||void 0===G?void 0:G.tickets.length)&&(0,i.jsx)(b.Tr,{children:(0,i.jsx)(b.Td,{colSpan:11,textAlign:"center",p:4,children:"No ticket(s) found"})}),null===G||void 0===G?void 0:G.tickets.map((function(e,t){var r;return(0,i.jsxs)(b.Tr,{_hover:{backgroundColor:"#efefef"},children:[(0,i.jsx)(b.Td,{children:(G.page-1)*G.limit+(t+1)}),(0,i.jsx)(b.Td,{children:(0,i.jsx)(l(),{href:"/ticket/".concat(e.ticket_id),children:(0,i.jsx)("a",{className:"underline",children:e.ticket_id})})}),(0,i.jsx)(b.Td,{children:e.Product.product_name}),(0,i.jsx)(b.Td,{children:e.CaseSubject.subject}),(0,i.jsx)(b.Td,{children:u()(e.created_date).format("YYYY-MM-DD HH:mm:ss")}),(0,i.jsx)(b.Td,{children:(0,i.jsx)(E.Z,{severity:e.CaseSubject.severity})}),(0,i.jsx)(b.Td,{children:null===(r=e.pic)||void 0===r?void 0:r.name}),(0,i.jsx)(b.Td,{children:e.createdBy.name}),(0,i.jsx)(b.Td,{children:(0,i.jsx)(T.Ct,{colorScheme:"OPEN"===e.status?"yellow":"PROGRESS"===e.status?"green":"gray",children:e.status})}),(0,i.jsx)(b.Td,{children:"CLOSED"!==e.status?(0,i.jsx)(T.Ct,{color:e.sla>1?"green.800":e.sla>=0?"yellow.800":"black",bgColor:e.sla>1?"green.200":e.sla>=0?"yellow.200":"blackAlpha.200",children:e.sla>=1?"Due in ".concat(e.sla," days"):e.sla>=0?"Due today":"Overdue for ".concat(e.sla," days")}):(0,i.jsx)(T.Ct,{children:"Closed"})}),(0,i.jsx)(b.Td,{children:(0,i.jsxs)(S.hE,{isAttached:!0,display:"flex",justifyContent:"center",alignItems:"center",children:[(0,i.jsx)(l(),{href:"/ticket/".concat(e.ticket_id),passHref:!0,children:(0,i.jsx)(S.hU,{size:"sm",colorScheme:"blue",icon:(0,i.jsx)(p.FpO,{}),w:"full",children:"View"})}),"OPEN"===e.status&&o.includes("TICKET_ACTION")&&e.created_by!==n.id&&(0,i.jsx)(w.u,{hasArrow:!0,label:"Take Ticket",color:"green.50",bgColor:"green.500",children:(0,i.jsx)(S.hU,{size:"sm",colorScheme:"green",onClick:function(){q(),re(e)},icon:(0,i.jsx)(j.yf9,{}),w:"full",children:"Take"})}),e.created_by===(null===n||void 0===n?void 0:n.id)&&"OPEN"===e.status&&(0,i.jsx)(w.u,{hasArrow:!0,label:"Delete Ticket",color:"red.50",bgColor:"red.500",children:(0,i.jsx)(S.hU,{size:"sm",colorScheme:"red",onClick:function(){$(),re(e)},icon:(0,i.jsx)(p.ZkW,{}),w:"full",children:"Delete"})})]})})]},e.ticket_id)})),(0,i.jsx)(b.Tr,{children:(0,i.jsxs)(b.Td,{colSpan:11,textAlign:"start",children:[(0,i.jsx)(S.hU,{icon:(0,i.jsx)(D.YFh,{}),variant:"outline",size:"sm",ml:4,disabled:!(null===G||void 0===G?void 0:G.previous),onClick:H}),(0,i.jsx)(S.hU,{icon:(0,i.jsx)(D.Tfp,{}),variant:"outline",size:"sm",ml:1,disabled:!(null===G||void 0===G?void 0:G.next),onClick:N}),(0,i.jsxs)(T.xv,{display:"inline",fontWeight:"medium",children:["Showing ",null===G||void 0===G?void 0:G.total," of ",null===G||void 0===G?void 0:G.stats.total]}),(0,i.jsx)(T.iz,{orientation:"vertical",display:"inline",mx:2}),(0,i.jsxs)(T.xv,{display:"inline",fontWeight:"normal",children:["Page ",null===G||void 0===G?void 0:G.page]})]})})]})]})})]})}},7361:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});var r=[{level:1,label:"LOW",handle_in:10},{level:2,label:"MEDIUM",handle_in:5},{level:3,label:"HIGH",handle_in:3},{level:4,label:"CRITICAL",handle_in:1}]},4548:function(e,t,n){"use strict";n.d(t,{Q:function(){return h}});var r=n(4924),o=n(6042),s=n(9396),i=n(9534),c=n(136),a=n(5893),l=n(7294),d=n(1163),u=l.createContext();t.Z=function(e){var t=e.children,n=e.initialPage,h=(0,l.useState)(n||1),x=h[0],p=h[1],j=(0,l.useState)("created_date"),v=j[0],f=j[1],m=(0,l.useState)("desc"),g=m[0],_=m[1],k=(0,l.useState)({}),C=k[0],b=k[1],y=(0,d.useRouter)();(0,l.useEffect)((function(){y.push("/?page=".concat(x),void 0,{shallow:!0})}),[x]);return(0,a.jsx)(u.Provider,{value:{page:x,sortBy:v,sortOrder:g,filter:C,fetchNextPage:function(){p((function(e){return e+1}))},fetchPreviousPage:function(){p((function(e){return e-1}))},changeSort:function(e,t){v!==e||t||_((function(e){return"asc"===e?"desc":"asc"})),f(e),t&&_(t),p(1)},addFilter:function(e,t){0===t.trim().length?b((function(t){t[e];return(0,i.Z)(t,[e].map(c.Z))})):b((function(n){return(0,s.Z)((0,o.Z)({},n),(0,r.Z)({},e,t))})),p(1)},setPage:p},children:t})};var h=function(){return(0,l.useContext)(u)}},4641:function(e){e.exports={badge:"Badge_badge__gRwm0",badge_low:"Badge_badge_low__ZHIef",checked:"Badge_checked__yIQLV",badge_medium:"Badge_badge_medium__rNHa1",badge_high:"Badge_badge_high__FlPL4",badge_critical:"Badge_badge_critical__ZFOPm"}}}]);